# AI è¯­éŸ³é—®è¯ŠåŠŸèƒ½è®¾è®¡æ–‡æ¡£

**ç‰ˆæœ¬**: V1.0  
**è®¾è®¡æ—¥æœŸ**: 2026-01-18  
**çŠ¶æ€**: è®¾è®¡è¯„å®¡ä¸­  
**è®¾è®¡åŸåˆ™**: ä¼ä¸šçº§ä½“éªŒã€å¾®ä¿¡é€šè¯é£æ ¼ã€ç”¨æˆ·å‹å¥½

---

## ä¸€ã€åŠŸèƒ½æ¦‚è¿°

### 1.1 æ ¸å¿ƒéœ€æ±‚

**åœ¨ç°æœ‰å¯¹è¯ç•Œé¢ä¸­å¢åŠ è¯­éŸ³äº¤äº’èƒ½åŠ›**ï¼Œç”¨æˆ·å¯ä»¥è‡ªç”±åˆ‡æ¢æ–‡å­—/è¯­éŸ³è¾“å…¥ï¼š
- **è¯­éŸ³æ¨¡å¼åˆ‡æ¢**: ç‚¹å‡»éº¦å…‹é£æŒ‰é’®è¿›å…¥è¯­éŸ³å¯¹è¯æ¨¡å¼
- **å®æ—¶è¯­éŸ³è¯†åˆ«**: è¯´è¯æ—¶è‡ªåŠ¨è¯†åˆ«è½¬æ–‡å­—ï¼Œæ˜¾ç¤ºåœ¨å¯¹è¯æ¡†
- **AI è¯­éŸ³æ’­æŠ¥**: AI å›å¤è‡ªåŠ¨æœ—è¯»ï¼Œæ”¯æŒæ‰“æ–­
- **æ–‡å­—/è¯­éŸ³å…±å­˜**: åŒä¸€å¯¹è¯ä¸­å¯æ··ç”¨æ–‡å­—å’Œè¯­éŸ³
- **æ— ç¼åˆ‡æ¢**: éšæ—¶åœ¨æ–‡å­—è¾“å…¥å’Œè¯­éŸ³è¾“å…¥é—´åˆ‡æ¢

### 1.2 å‚è€ƒæ ‡æ†

- **å°è· AI åŒ»ç”Ÿ**: å¯¹è¯ç•Œé¢é›†æˆè¯­éŸ³ï¼Œæ–‡å­—/è¯­éŸ³è‡ªç”±åˆ‡æ¢
- **å¾®ä¿¡èŠå¤©**: é•¿æŒ‰è¯­éŸ³è¾“å…¥ï¼Œç‚¹å‡»åˆ‡æ¢è¾“å…¥æ–¹å¼
- **ä¼ä¸šçº§åŒ»ç–— App**: ä¸“ä¸šä¿¡ä»»æ„Ÿã€æ— éšœç¢è®¾è®¡ã€éšç§ä¿æŠ¤

### 1.3 æŠ€æœ¯æ–¹æ¡ˆ

é‡‡ç”¨ **iOS åŸç”Ÿè¯­éŸ³ SDK + VAD**ï¼š
- **è¯­éŸ³è¯†åˆ«**: `Speech Framework` (SFSpeechRecognizer) æŒç»­è¯†åˆ«æ¨¡å¼
- **è¯­éŸ³åˆæˆ**: `AVSpeechSynthesizer`
- **VAD**: `AVAudioEngine` å®æ—¶éŸ³é‡æ£€æµ‹ï¼Œè‡ªåŠ¨åˆ¤æ–­è¯´è¯/é™é»˜
- **åç«¯**: å¤ç”¨ç°æœ‰ `/sessions` APIï¼Œæ— éœ€æ”¹åŠ¨

---

## äºŒã€ç”¨æˆ·æ—…ç¨‹

### 2.1 å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·æ—…ç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  1. è¿›å…¥å¯¹è¯ç•Œé¢                                                   â”‚
â”‚     â””â”€â”€ é¦–é¡µé€‰æ‹©ç§‘å®¤åè¿›å…¥å¯¹è¯ï¼ˆå¤ç”¨ç°æœ‰ UnifiedChatViewï¼‰          â”‚
â”‚                                                                   â”‚
â”‚  2. æ–‡å­—æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰                                               â”‚
â”‚     â”œâ”€â”€ åº•éƒ¨è¾“å…¥æ¡† + å‘é€æŒ‰é’®                                      â”‚
â”‚     â”œâ”€â”€ å³ä¾§æ˜¾ç¤ºéº¦å…‹é£å›¾æ ‡æŒ‰é’®                                      â”‚
â”‚     â””â”€â”€ å¯æ­£å¸¸æ–‡å­—èŠå¤©                                            â”‚
â”‚                                                                   â”‚
â”‚  3. åˆ‡æ¢åˆ°è¯­éŸ³æ¨¡å¼                                                 â”‚
â”‚     â”œâ”€â”€ ç‚¹å‡»éº¦å…‹é£æŒ‰é’®                                            â”‚
â”‚     â”œâ”€â”€ è¯·æ±‚éº¦å…‹é£æƒé™ï¼ˆé¦–æ¬¡ï¼‰                                      â”‚
â”‚     â”œâ”€â”€ åº•éƒ¨æ˜¾ç¤ºè¯­éŸ³æ§åˆ¶æ                                          â”‚
â”‚     â””â”€â”€ æ˜¾ç¤ºã€Œç‚¹å‡»æˆ–è¯´è¯æ‰“æ–­ã€æç¤º                                  â”‚
â”‚                                                                   â”‚
â”‚  4. è¯­éŸ³å¯¹è¯ä¸­                                                     â”‚
â”‚     â”œâ”€â”€ ç”¨æˆ·è¯´è¯ â†’ å®æ—¶è¯†åˆ« â†’ æ˜¾ç¤ºåœ¨è¾“å…¥æ¡†                         â”‚
â”‚     â”œâ”€â”€ åœé¡¿ 2 ç§’ â†’ è‡ªåŠ¨å‘é€                                      â”‚
â”‚     â”œâ”€â”€ AI å›å¤ â†’ æ–‡å­—æ˜¾ç¤º + è¯­éŸ³æ’­æŠ¥                             â”‚
â”‚     â”œâ”€â”€ ç”¨æˆ·å¯éšæ—¶æ‰“æ–­ AI è¯´è¯                                     â”‚
â”‚     â””â”€â”€ æ˜¾ç¤ºè¯­éŸ³æ³¢å½¢åŠ¨ç”»                                          â”‚
â”‚                                                                   â”‚
â”‚  5. åˆ‡æ¢å›æ–‡å­—æ¨¡å¼                                                 â”‚
â”‚     â””â”€â”€ ç‚¹å‡»ã€Œå­—å¹•ã€æŒ‰é’®æˆ–è¾“å…¥æ¡†å³å¯åˆ‡å›                            â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è¯­éŸ³æ¨¡å¼çŠ¶æ€æœº

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ç‚¹å‡»éº¦å…‹é£    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    æ£€æµ‹åˆ°è¯´è¯    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–‡å­—æ¨¡å¼ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚  å¾…æœºä¸­  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚  è¯†åˆ«ä¸­  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â–²                           â–²                          â”‚
      â”‚ ç‚¹å‡»ã€Œå­—å¹•ã€                â”‚                          â”‚ é™é»˜ 2 ç§’
      â”‚                           â”‚ AI è¯´å®Œ                   â–¼
      â”‚                           â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  å‘é€ä¸­  â”‚
      â”‚                     â”‚ AI æ’­æŠ¥  â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
      â”‚                           â–²                          â”‚
      â”‚                           â”‚                          â”‚ AI å›å¤
      â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                    â”‚
      â”‚                                    â”‚ ç”¨æˆ·è¯´è¯(æ‰“æ–­)
      â”‚                                    â–¼
      â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  è¯†åˆ«ä¸­  â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€ç•Œé¢è®¾è®¡

### 3.1 è®¾è®¡ç†å¿µ

**æ ¸å¿ƒé£æ ¼**: AI-Native UI + Zero Interface + Trust & Authority

| è®¾è®¡åŸåˆ™ | è¯´æ˜ |
|---------|------|
| **æç®€å…å¹²æ‰°** | é€šè¯æ—¶åªæ˜¾ç¤ºå¿…è¦å…ƒç´ ï¼Œè®©ç”¨æˆ·ä¸“æ³¨å¯¹è¯ |
| **è¯­éŸ³ä¼˜å…ˆ** | ç•Œé¢æœåŠ¡äºè¯­éŸ³ï¼Œä¸è®©è§†è§‰å…ƒç´ åˆ†æ•£æ³¨æ„åŠ› |
| **ä¿¡ä»»ä¸ä¸“ä¸š** | åŒ»ç–—åœºæ™¯éœ€è¦ä¸“ä¸šæ„Ÿã€å®‰å…¨æ„Ÿã€ä¿¡èµ–æ„Ÿ |
| **æ— éšœç¢ä¼˜å…ˆ** | WCAG AAA æ ‡å‡†ï¼Œé«˜å¯¹æ¯”åº¦ï¼Œè§¦è§‰åé¦ˆ |

### 3.2 è®¾è®¡ç³»ç»Ÿ

#### é¢œè‰²ä½“ç³»

**ä¸»è‰²è°ƒ**: ä¸­æ€§ç™½ + å•ä¸€å¼ºè°ƒè‰²ï¼ˆAI Purpleï¼‰+ åŒ»ç–—ä¿¡ä»»è“

| ç”¨é€” | é¢œè‰²åç§° | Hex | è¯´æ˜ |
|------|----------|-----|------|
| Background | Soft White | `#FAFAFA` | æç®€èƒŒæ™¯ï¼Œæ— å¹²æ‰° |
| Surface | Pure White | `#FFFFFF` | å¡ç‰‡/æ°”æ³¡èƒŒæ™¯ |
| AI Accent | AI Purple | `#6366F1` | AIçŠ¶æ€å¼ºè°ƒè‰² |
| Trust Blue | Medical Blue | `#0077B6` | åŒ»ç–—ä¿¡ä»»è‰² |
| Success | Health Green | `#10B981` | æˆåŠŸ/æ´»è·ƒçŠ¶æ€ |
| Text Primary | Deep Black | `#1D1D1F` | ä¸»æ–‡å­—ï¼Œé«˜å¯¹æ¯” |
| Text Secondary | Slate Gray | `#64748B` | æ¬¡è¦æ–‡å­— |
| Text Muted | Light Gray | `#94A3B8` | æç¤ºæ–‡å­— |
| Danger | End Red | `#EF4444` | æŒ‚æ–­æŒ‰é’® |
| Listening | Pulse Blue | `#3B82F6` | ç›‘å¬ä¸­çŠ¶æ€ |
| Border | Soft Gray | `#E5E7EB` | è¾¹æ¡†/åˆ†å‰²çº¿ |

#### å­—ä½“ç³»ç»Ÿ

| ç”¨é€” | å­—ä½“ | å­—å· | å­—é‡ | è¡Œé«˜ |
|------|------|------|------|------|
| åŒ»ç”Ÿåç§° | SF Pro Display | 22pt | Semibold | 28pt |
| çŠ¶æ€æŒ‡ç¤º | SF Pro Text | 15pt | Medium | 20pt |
| å­—å¹•æ–‡å­— | SF Pro Text | 16pt | Regular | 24pt |
| æ—¶é—´æˆ³ | SF Pro Text | 12pt | Regular | 16pt |
| æŒ‰é’®æ–‡å­— | SF Pro Text | 15pt | Semibold | 20pt |

#### é—´è·ç³»ç»Ÿï¼ˆåŸºäº 8pt ç½‘æ ¼ï¼‰

| Token | å€¼ | ç”¨é€” |
|-------|-----|------|
| spacing-xs | 4px | å…ƒç´ å†…éƒ¨å¾®è°ƒ |
| spacing-sm | 8px | ç´§å‡‘å…ƒç´ é—´è· |
| spacing-md | 16px | æ ‡å‡†å…ƒç´ é—´è· |
| spacing-lg | 24px | åŒºå—é—´è· |
| spacing-xl | 32px | å¤§åŒºå—é—´è· |
| spacing-2xl | 48px | é¡µé¢çº§é—´è· |

#### åœ†è§’ç³»ç»Ÿ

| å…ƒç´  | åœ†è§’ | è¯´æ˜ |
|------|------|------|
| å¤´åƒ | å…¨åœ† | åŒ»ç”Ÿå¤´åƒ |
| å­—å¹•æ°”æ³¡ | 20px | æŸ”å’Œè§†è§‰ |
| æŒ‰é’®ï¼ˆåœ†å½¢ï¼‰ | å…¨åœ† | æŒ‚æ–­ã€æ‹ç…§ |
| å¡ç‰‡ | 16px | ç§‘å®¤é€‰æ‹©å¡ |
| è¾“å…¥æ¡† | 12px | æ–‡å­—è¾“å…¥ |

### 3.3 æ ¸å¿ƒç•Œé¢ï¼šå¯¹è¯ç•Œé¢ï¼ˆæ–‡å­—æ¨¡å¼ï¼‰

**è®¾è®¡è¦ç‚¹**: å¤ç”¨ç°æœ‰ UnifiedChatViewï¼Œåœ¨åº•éƒ¨æ·»åŠ è¯­éŸ³åˆ‡æ¢æŒ‰é’®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚  â†  å°è·AIåŒ»ç”Ÿ              ğŸ”‡  â‹®       â”‚  â† å¯¼èˆªæ ï¼šè¿”å› + åç§° + é™éŸ³ + æ›´å¤š
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚    â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚
â”‚ â†â”€â”€â”‚ æ‚¨å¥½ï¼Œæˆ‘æ˜¯AIçš®è‚¤ç§‘åŒ»ç”Ÿï¼Œ         â”‚  â”‚  â† AIæ¶ˆæ¯ï¼ˆå·¦ä¾§ï¼Œç™½åº•ï¼‰
â”‚    â”‚ è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ             â”‚  â”‚
â”‚    â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚
â”‚                                         â”‚
â”‚  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®    â”‚
â”‚  â”‚ æˆ‘æ‰‹è‡‚ä¸Šæœ‰çº¢ç–¹ï¼Œå¾ˆç—’             â”‚â”€â”€â†’ â”‚  â† ç”¨æˆ·æ¶ˆæ¯ï¼ˆå³ä¾§ï¼Œç»¿åº•ï¼‰
â”‚  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯    â”‚
â”‚                                         â”‚
â”‚    â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚
â”‚ â†â”€â”€â”‚ è¿™ä¸ªçº¢ç–¹æ˜¯ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹çš„ï¼Ÿ     â”‚  â”‚
â”‚    â”‚ æœ‰æ²¡æœ‰æ¥è§¦è¿‡ä»€ä¹ˆè¿‡æ•æºï¼Ÿ         â”‚  â”‚
â”‚    â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”  â”Œâ”€â”  â”Œâ”€â”                          â”‚  â† å¿«æ·æ“ä½œï¼ˆå¯é€‰ï¼‰
â”‚  â”‚ğŸ“‹â”‚  â”‚ğŸ“Šâ”‚  â”‚ğŸ¯â”‚                          â”‚     é—¨è¯Šå¸®æ‰‹ã€æŠ¥å‘Šè§£è¯»ã€æ‹æ‚£å¤„
â”‚  â””â”€â”˜  â””â”€â”˜  â””â”€â”˜                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  âŠ™  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  ğŸ–¼  ğŸ“ â”‚  â† åº•éƒ¨è¾“å…¥æ 
â”‚      â”‚ è¾“å…¥é—®é¢˜ æˆ– æŒ‰ä½è¯´è¯      â”‚         â”‚     è¯­éŸ³æŒ‰é’® + è¾“å…¥æ¡† + å›¾ç‰‡ + ç”µè¯
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 æ ¸å¿ƒç•Œé¢ï¼šå¯¹è¯ç•Œé¢ï¼ˆè¯­éŸ³æ¨¡å¼ï¼‰

**è®¾è®¡è¦ç‚¹**: ç‚¹å‡»éº¦å…‹é£åï¼Œåº•éƒ¨åˆ‡æ¢ä¸ºè¯­éŸ³æ§åˆ¶æ ï¼ŒèƒŒæ™¯å˜ä¸ºæµ…ç»¿è‰²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚  â†  å°è·AIåŒ»ç”Ÿ              å­—å¹•        â”‚  â† å¯¼èˆªæ ï¼šå³ä¸Šè§’æ˜¾ç¤ºã€Œå­—å¹•ã€åˆ‡æ¢æŒ‰é’®
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚    â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚
â”‚ â†â”€â”€â”‚ æ‚¨å¥½ï¼å¿ƒè„ä¸èˆ’æœå¯ä¸èƒ½å¤§æ„ã€‚     â”‚  â”‚  â† AIæ¶ˆæ¯
â”‚    â”‚ æ‚¨ç°åœ¨æ˜¯æ€ä¹ˆä¸ªä¸èˆ’æœæ³•ï¼Ÿ         â”‚  â”‚
â”‚    â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚
â”‚                                         â”‚
â”‚  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®    â”‚
â”‚  â”‚ æˆ‘ä¼°è®¡æ˜¯æˆ‘çš„æˆ‘å‰é˜µå­æˆ‘è§‰å¾—æˆ‘     â”‚â”€â”€â†’ â”‚  â† ç”¨æˆ·è¯­éŸ³è¯†åˆ«æ¶ˆæ¯
â”‚  â”‚ è¿™ä¸ªé¢ˆæ¤å¥½ä¸èˆ’æœæ¯æ¬¡è‡ªå·±è¦æ‘     â”‚  â”‚
â”‚  â”‚ æ‰‹æã€‚è¿™ä¸æ˜¯çš„å†å»çœ‹ä¸€ä¸‹é¢ˆæ¤     â”‚  â”‚
â”‚  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯    â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”‚          ç‚¹å‡»æˆ–è¯´è¯æ‰“æ–­                  â”‚  â† æç¤ºæ–‡å­—ï¼ˆå±…ä¸­ï¼Œç°è‰²ï¼‰
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚  â† èƒŒæ™¯å˜ä¸ºæµ…ç»¿è‰² (#E8F5E9)
â”‚       âŠ™        âœ¨        ğŸ–¼        âœ•     â”‚  â† è¯­éŸ³æ§åˆ¶æ 
â”‚      éº¦å…‹é£    AIç”Ÿæˆ    å›¾ç‰‡     å…³é—­    â”‚     éº¦å…‹é£ + AIåŠŸèƒ½ + å›¾ç‰‡ + å…³é—­è¯­éŸ³
â”‚                                         â”‚
â”‚            å†…å®¹ç”± AI ç”Ÿæˆ                â”‚  â† åº•éƒ¨æç¤º
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¯­éŸ³æ¨¡å¼ç‰¹ç‚¹**:
- èƒŒæ™¯è‰²å˜ä¸ºæµ…ç»¿è‰² `#E8F5E9`ï¼Œè¡¨ç¤ºè¯­éŸ³æ¨¡å¼æ¿€æ´»
- åº•éƒ¨æ˜¾ç¤ºè¯­éŸ³æ§åˆ¶æ ï¼ŒåŒ…å«éº¦å…‹é£ã€AIåŠŸèƒ½ã€å›¾ç‰‡ã€å…³é—­æŒ‰é’®
- ä¸­é—´æ˜¾ç¤ºã€Œç‚¹å‡»æˆ–è¯´è¯æ‰“æ–­ã€æç¤º
- å³ä¸Šè§’æ˜¾ç¤ºã€Œå­—å¹•ã€æŒ‰é’®ï¼Œç‚¹å‡»å¯åˆ‡æ¢å›æ–‡å­—æ¨¡å¼

### 3.5 åˆ é™¤ç§‘å®¤é€‰æ‹©é¡µ

**åŸå› **: ç”¨æˆ·å·²åœ¨é¦–é¡µé€‰æ‹©ç§‘å®¤ï¼ˆå¦‚çš®è‚¤ç§‘ã€å¿ƒè¡€ç®¡ç§‘ç­‰ï¼‰ï¼Œè¿›å…¥å¯¹è¯åç›´æ¥ä½¿ç”¨è¯­éŸ³åŠŸèƒ½å³å¯ï¼Œæ— éœ€å†æ¬¡é€‰æ‹©ã€‚

### 3.6 å®æ—¶è¯†åˆ«çŠ¶æ€æ˜¾ç¤º

**è®¾è®¡è¦ç‚¹**: ç”¨æˆ·è¯´è¯æ—¶ï¼Œåœ¨è¾“å…¥æ¡†ä½ç½®å®æ—¶æ˜¾ç¤ºè¯†åˆ«æ–‡å­—

```
è¯­éŸ³è¯†åˆ«ä¸­çš„çŠ¶æ€ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚  âŠ™  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â† éº¦å…‹é£å›¾æ ‡ + è¯†åˆ«æ–‡å­—
â”‚      â”‚ æˆ‘ä¼°è®¡æ˜¯æˆ‘çš„æˆ‘å‰é˜µå­...  â”‚  ğŸ”´     â”‚     å³ä¾§æ˜¾ç¤ºå½•éŸ³æŒ‡ç¤ºç¯
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AI æ’­æŠ¥ä¸­çš„çŠ¶æ€ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚    â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚
â”‚ â†â”€â”€â”‚ æ‚¨å¥½ï¼å¿ƒè„ä¸èˆ’æœå¯ä¸èƒ½å¤§æ„ã€‚     â”‚  â”‚  â† AIæ¶ˆæ¯æ°”æ³¡
â”‚    â”‚ æ‚¨ç°åœ¨æ˜¯æ€ä¹ˆä¸ªä¸èˆ’æœæ³•ï¼Ÿ         â”‚ ğŸ”Šâ”‚     å³ä¾§æ˜¾ç¤ºæ’­æŠ¥å›¾æ ‡
â”‚    â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€äº¤äº’ç»†èŠ‚

### 4.1 è¯­éŸ³æ¨¡å¼äº¤äº’æµç¨‹

**ç‚¹å‡»éº¦å…‹é£è¿›å…¥è¯­éŸ³æ¨¡å¼ï¼Œè‡ªåŠ¨ç›‘å¬ç”¨æˆ·è¯´è¯**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é˜¶æ®µ              â”‚  ç³»ç»Ÿè¡Œä¸º                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç‚¹å‡»éº¦å…‹é£        â”‚  - åˆ‡æ¢åˆ°è¯­éŸ³æ¨¡å¼                       â”‚
â”‚                   â”‚  - èƒŒæ™¯å˜ä¸ºæµ…ç»¿è‰²                       â”‚
â”‚                   â”‚  - åº•éƒ¨æ˜¾ç¤ºè¯­éŸ³æ§åˆ¶æ                     â”‚
â”‚                   â”‚  - å¼€å¯ VAD æŒç»­ç›‘å¬                    â”‚
â”‚  æ£€æµ‹åˆ°è¯´è¯        â”‚  - å¦‚æœ AI æ­£åœ¨æ’­æŠ¥ â†’ ç«‹å³ä¸­æ–­          â”‚
â”‚                   â”‚  - å¼€å§‹è¯­éŸ³è¯†åˆ«                         â”‚
â”‚                   â”‚  - åœ¨è¾“å…¥æ¡†ä½ç½®æ˜¾ç¤ºè¯†åˆ«æ–‡å­—              â”‚
â”‚                   â”‚  - å³ä¾§æ˜¾ç¤ºå½•éŸ³æŒ‡ç¤ºç¯ ğŸ”´                â”‚
â”‚  ç”¨æˆ·è¯´è¯ä¸­        â”‚  - æŒç»­è¯†åˆ«ï¼Œæ›´æ–°è¾“å…¥æ¡†æ–‡å­—              â”‚
â”‚  é™é»˜ 2 ç§’         â”‚  - åˆ¤å®šç”¨æˆ·è¯´å®Œ                         â”‚
â”‚                   â”‚  - è‡ªåŠ¨å‘é€æ¶ˆæ¯                         â”‚
â”‚                   â”‚  - æ¸…ç©ºè¾“å…¥æ¡†                           â”‚
â”‚  AI å›å¤           â”‚  - æ¶ˆæ¯æ°”æ³¡æ˜¾ç¤º AI å›å¤                 â”‚
â”‚                   â”‚  - TTS è‡ªåŠ¨æ’­æŠ¥                         â”‚
â”‚                   â”‚  - æ°”æ³¡å³ä¾§æ˜¾ç¤ºæ’­æŠ¥å›¾æ ‡ ğŸ”Š              â”‚
â”‚  AI è¯´å®Œ           â”‚  - æ¢å¤ç›‘å¬çŠ¶æ€                         â”‚
â”‚                   â”‚  - ç­‰å¾…ç”¨æˆ·ä¸‹ä¸€å¥                        â”‚
â”‚  ç‚¹å‡»ã€Œå­—å¹•ã€      â”‚  - é€€å‡ºè¯­éŸ³æ¨¡å¼                         â”‚
â”‚                   â”‚  - æ¢å¤æ–‡å­—è¾“å…¥ç•Œé¢                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**VAD å‚æ•°é…ç½®**:
```swift
// éŸ³é‡é˜ˆå€¼ï¼ˆé¿å…ç¯å¢ƒå™ªéŸ³è¯¯è§¦å‘ï¼‰
let volumeThreshold: Float = 0.15  // 0-1

// é™é»˜åˆ¤å®šæ—¶é•¿
let silenceDuration: TimeInterval = 2.0  // ç§’

// æœ€å°è¯´è¯æ—¶é•¿ï¼ˆè¿‡æ»¤çŸ­ä¿ƒå™ªéŸ³ï¼‰
let minSpeechDuration: TimeInterval = 0.3  // ç§’
```

### 4.2 æ™ºèƒ½æ‰“æ–­æœºåˆ¶

**ç”¨æˆ·å¯éšæ—¶æ‰“æ–­ AI æ’­æŠ¥**

```swift
// æ£€æµ‹åˆ°ç”¨æˆ·è¯´è¯æ—¶
if isAISpeaking && audioLevel > volumeThreshold {
    // 1. ç«‹å³åœæ­¢ TTS æ’­æŠ¥
    synthesizer.stopSpeaking(at: .immediate)
    
    // 2. åˆ‡æ¢çŠ¶æ€
    callState = .listening
    
    // 3. å¼€å§‹è¯†åˆ«ç”¨æˆ·æ–°è¾“å…¥
    startRecognition()
    
    // 4. è§¦è§‰åé¦ˆ
    UIImpactFeedbackGenerator(style: .light).impactOccurred()
}
```

### 4.3 AI æ’­æŠ¥æ—¶çš„è¡¨ç°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å…ƒç´               â”‚  æ•ˆæœ                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¶ˆæ¯æ°”æ³¡          â”‚  æ­£å¸¸æ˜¾ç¤º AI å›å¤æ–‡å­—                   â”‚
â”‚  æ’­æŠ¥å›¾æ ‡          â”‚  æ°”æ³¡å³ä¾§æ˜¾ç¤º ğŸ”Š å›¾æ ‡                  â”‚
â”‚  è¯­éŸ³è¾“å‡º          â”‚  AVSpeechSynthesizer æœ—è¯»              â”‚
â”‚  ç”¨æˆ·æ‰“æ–­          â”‚  æ£€æµ‹åˆ°è¯´è¯ç«‹å³åœæ­¢æ’­æŠ¥                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 å®æ—¶è¯†åˆ«æ˜¾ç¤º

```swift
// è¯†åˆ«æ–‡å­—æ˜¾ç¤ºè§„åˆ™
1. ç”¨æˆ·è¯´è¯æ—¶ï¼šåœ¨è¾“å…¥æ¡†ä½ç½®å®æ—¶æ˜¾ç¤ºè¯†åˆ«æ–‡å­—
2. å³ä¾§æ˜¾ç¤ºå½•éŸ³æŒ‡ç¤ºç¯ï¼ˆçº¢è‰²åœ†ç‚¹ï¼‰
3. é™é»˜ 2 ç§’åï¼šè‡ªåŠ¨å‘é€ï¼Œè½¬ä¸ºæ¶ˆæ¯æ°”æ³¡
4. AI å›å¤æ—¶ï¼šæ­£å¸¸æ˜¾ç¤ºåœ¨æ¶ˆæ¯åˆ—è¡¨
5. AI æ’­æŠ¥æ—¶ï¼šæ°”æ³¡å³ä¾§æ˜¾ç¤ºæ’­æŠ¥å›¾æ ‡
```

### 4.5 å½•éŸ³æŒ‡ç¤º

```
ç”¨æˆ·è¯´è¯æ—¶çš„è§†è§‰åé¦ˆï¼š

1. è¾“å…¥æ¡†å³ä¾§æ˜¾ç¤ºçº¢è‰²åœ†ç‚¹ ğŸ”´
2. åœ†ç‚¹æœ‰å‘¼å¸åŠ¨ç”»ï¼ˆscale 0.8 â†” 1.0ï¼‰
3. åŠ¨ç”»å‘¨æœŸï¼š1.5s
4. åœæ­¢è¯´è¯ååœ†ç‚¹æ¶ˆå¤±
```

### 4.6 é”™è¯¯å¤„ç†

| é”™è¯¯åœºæ™¯ | æç¤ºæ–¹å¼ | æ¢å¤æ“ä½œ |
|----------|----------|----------|
| éº¦å…‹é£æƒé™è¢«æ‹’ | å¼¹çª—å¼•å¯¼å¼€å¯ | è·³è½¬ç³»ç»Ÿè®¾ç½® |
| è¯­éŸ³è¯†åˆ«å¤±è´¥ | Toastã€Œæ²¡å¬æ¸…ï¼Œè¯·å†è¯´ä¸€æ¬¡ã€| è‡ªåŠ¨é‡è¯• |
| ç½‘ç»œæ–­å¼€ | é¡¶éƒ¨çº¢æ¡ã€Œç½‘ç»œå·²æ–­å¼€ã€| è‡ªåŠ¨é‡è¿ |
| AI å“åº”è¶…æ—¶ | Toastã€ŒåŒ»ç”Ÿç¹å¿™ï¼Œè¯·ç¨åã€| é‡è¯•æŒ‰é’® |
| TTS æ’­æ”¾å¤±è´¥ | é™é»˜é™çº§ï¼Œåªæ˜¾ç¤ºæ–‡å­— | - |

### 4.7 æ— éšœç¢è®¾è®¡

```swift
// VoiceOver æ”¯æŒ
- æ‰€æœ‰æŒ‰é’®æ·»åŠ  accessibilityLabel
- çŠ¶æ€å˜åŒ–æ—¶ä½¿ç”¨ UIAccessibility.post é€šçŸ¥
- å­—å¹•åŒºæ”¯æŒåŠ¨æ€å­—ä½“ (Dynamic Type)
- å…ææ¨¡å¼å¯¹è§†éšœç”¨æˆ·æ›´å‹å¥½

// ç¤ºä¾‹
Button(action: endCall) {
    Image(systemName: "phone.down.fill")
    Text("æŒ‚æ–­")
}
.accessibilityLabel("æŒ‚æ–­é€šè¯")
.accessibilityHint("ç»“æŸä¸AIåŒ»ç”Ÿçš„è¯­éŸ³é—®è¯Š")

// çŠ¶æ€å˜åŒ–é€šçŸ¥
UIAccessibility.post(
    notification: .announcement,
    argument: "åŒ»ç”Ÿæ­£åœ¨å›å¤"
)
```

---

## äº”ã€æŠ€æœ¯æ¶æ„

### 5.1 æ¨¡å—åˆ’åˆ†

```
ios/xinlingyisheng/xinlingyisheng/
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ RealtimeSpeechService.swift      # å®æ—¶è¯­éŸ³è¯†åˆ«æœåŠ¡
â”‚   â”œâ”€â”€ SpeechSynthesisService.swift     # è¯­éŸ³åˆæˆæœåŠ¡
â”‚   â””â”€â”€ AudioSessionManager.swift        # éŸ³é¢‘ä¼šè¯ç®¡ç†
â”‚
â”œâ”€â”€ ViewModels/
â”‚   â””â”€â”€ UnifiedChatViewModel.swift       # æ‰©å±•ç°æœ‰ ViewModel
â”‚       â”œâ”€â”€ æ·»åŠ è¯­éŸ³æ¨¡å¼çŠ¶æ€
â”‚       â”œâ”€â”€ é›†æˆè¯­éŸ³è¯†åˆ«
â”‚       â””â”€â”€ é›†æˆè¯­éŸ³æ’­æŠ¥
â”‚
â”œâ”€â”€ Views/
â”‚   â””â”€â”€ UnifiedChatView.swift            # ä¿®æ”¹ç°æœ‰èŠå¤©è§†å›¾
â”‚       â”œâ”€â”€ æ·»åŠ è¯­éŸ³æ¨¡å¼åˆ‡æ¢æŒ‰é’®
â”‚       â”œâ”€â”€ æ·»åŠ è¯­éŸ³æ§åˆ¶æ 
â”‚       â””â”€â”€ æ·»åŠ å®æ—¶è¯†åˆ«æ˜¾ç¤º
â”‚
â””â”€â”€ Components/
    â”œâ”€â”€ VoiceControlBar.swift            # è¯­éŸ³æ§åˆ¶æ ç»„ä»¶
    â”œâ”€â”€ RecordingIndicator.swift         # å½•éŸ³æŒ‡ç¤ºå™¨
    â””â”€â”€ SpeakingIndicator.swift          # æ’­æŠ¥æŒ‡ç¤ºå™¨
```

### 5.2 æ ¸å¿ƒç±»è®¾è®¡

#### UnifiedChatViewModel æ‰©å±•

```swift
@MainActor
class UnifiedChatViewModel: ObservableObject {
    // MARK: - ç°æœ‰å±æ€§ï¼ˆä¿æŒä¸å˜ï¼‰
    @Published var messages: [UnifiedChatMessage] = []
    @Published var inputText: String = ""
    // ...
    
    // MARK: - æ–°å¢ï¼šè¯­éŸ³æ¨¡å¼å±æ€§
    @Published var isVoiceMode: Bool = false  // æ˜¯å¦å¤„äºè¯­éŸ³æ¨¡å¼
    @Published var currentRecognition: String = ""  // å®æ—¶è¯†åˆ«æ–‡å­—
    @Published var isRecording: Bool = false  // æ˜¯å¦æ­£åœ¨å½•éŸ³
    @Published var isAISpeaking: Bool = false  // AI æ˜¯å¦æ­£åœ¨æ’­æŠ¥
    @Published var audioLevel: Float = 0  // éŸ³é‡çº§åˆ«
    
    // MARK: - æ–°å¢ï¼šè¯­éŸ³æœåŠ¡
    private let speechService: RealtimeSpeechService
    private let ttsService: SpeechSynthesisService
    
    // MARK: - æ–°å¢ï¼šè¯­éŸ³æ¨¡å¼æ–¹æ³•
    func toggleVoiceMode()  // åˆ‡æ¢è¯­éŸ³æ¨¡å¼
    func startListening()  // å¼€å§‹ç›‘å¬
    func stopListening()  // åœæ­¢ç›‘å¬
    func interruptAISpeech()  // æ‰“æ–­ AI æ’­æŠ¥
}

enum VoiceState {
    case idle  // å¾…æœº
    case listening  // ç›‘å¬ä¸­
    case recognizing  // è¯†åˆ«ä¸­
    case sending  // å‘é€ä¸­
    case aiSpeaking  // AI æ’­æŠ¥ä¸­
}
```

#### RealtimeSpeechService

```swift
class RealtimeSpeechService: ObservableObject {
    @Published var isRecording = false
    @Published var recognizedText = ""
    @Published var audioLevel: Float = 0
    
    private let speechRecognizer = SFSpeechRecognizer(locale: Locale(identifier: "zh-CN"))
    private var recognitionRequest: SFSpeechAudioBufferRecognitionRequest?
    private var recognitionTask: SFSpeechRecognitionTask?
    private let audioEngine = AVAudioEngine()
    
    // VAD å‚æ•°
    private let silenceThreshold: TimeInterval = 2.0  // é™é»˜åˆ¤å®šæ—¶é•¿
    private let volumeThreshold: Float = 0.15  // éŸ³é‡é˜ˆå€¼
    
    func requestAuthorization() async -> Bool
    func startContinuousRecognition(onPartialResult: @escaping (String) -> Void,
                                   onFinalResult: @escaping (String) -> Void) throws
    func stopRecognition()
}
```

#### SpeechSynthesisService

```swift
class SpeechSynthesisService: NSObject, ObservableObject {
    @Published var isSpeaking = false
    
    private let synthesizer = AVSpeechSynthesizer()
    
    func speak(
        text: String,
        rate: Float = 0.5,
        pitch: Float = 1.0,
        onStart: (() -> Void)? = nil,
        onFinish: (() -> Void)? = nil
    )
    
    func stop()
}
```

### 5.3 æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ç”¨æˆ·æŒ‰ä½è¯´è¯                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SpeechRecognitionService                                         â”‚
â”‚  - AVAudioEngine é‡‡é›†éŸ³é¢‘                                         â”‚
â”‚  - SFSpeechRecognizer å®æ—¶è¯†åˆ«                                    â”‚
â”‚  - å›è°ƒ: onResult(text, isFinal)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ è¯†åˆ«ç»“æœ
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VoiceCallViewModel                                               â”‚
â”‚  - æ›´æ–° currentRecognition (å®æ—¶)                                 â”‚
â”‚  - ç”¨æˆ·æ¾å¼€åï¼ŒisFinal=true                                       â”‚
â”‚  - æ·»åŠ åˆ° transcripts                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ è°ƒç”¨åç«¯
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ConversationViewModel.sendMessage()                              â”‚
â”‚  - POST /sessions/{id}/messages                                   â”‚
â”‚  - SSE æµå¼æ¥æ”¶ AI å›å¤                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ AI å›å¤
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VoiceCallViewModel                                               â”‚
â”‚  - æ·»åŠ  AI æ¶ˆæ¯åˆ° transcripts                                     â”‚
â”‚  - è°ƒç”¨ SpeechSynthesisService.speak()                           â”‚
â”‚  - è®¾ç½® isAISpeaking = true                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SpeechSynthesisService                                           â”‚
â”‚  - AVSpeechSynthesizer æœ—è¯»                                       â”‚
â”‚  - æœ—è¯»å®Œæˆå›è°ƒ                                                    â”‚
â”‚  - isAISpeaking = false                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 ä¸ç°æœ‰æ¶æ„é›†æˆ

```swift
// VoiceCallViewModel å†…éƒ¨å¤ç”¨ ConversationViewModel
class VoiceCallViewModel: ObservableObject {
    // å†…éƒ¨æŒæœ‰ç°æœ‰ä¼šè¯ VM
    private var conversationVM: ConversationViewModel?
    
    func startCall() async {
        // 1. åˆ›å»ºä¼šè¯ï¼ˆå¤ç”¨ç°æœ‰é€»è¾‘ï¼‰
        conversationVM = ConversationViewModel()
        await conversationVM?.createSession(agentType: selectedAgent)
        
        // 2. è®¢é˜… AI å›å¤
        conversationVM?.$messages
            .sink { [weak self] messages in
                self?.handleNewMessage(messages.last)
            }
            .store(in: &cancellables)
    }
    
    func sendVoiceMessage(_ text: String) async {
        // å¤ç”¨ç°æœ‰å‘é€é€»è¾‘
        await conversationVM?.sendMessage(content: text)
    }
}
```

---

## å…­ã€åŠ¨ç”»è§„èŒƒ

### 6.1 å‘¼å«ä¸­åŠ¨ç”»

```swift
// å¤´åƒå‘¼å¸åŠ¨ç”»
struct PulseAnimation: View {
    @State private var scale: CGFloat = 1.0
    @State private var opacity: Double = 0.6
    
    var body: some View {
        Circle()
            .fill(Color.medicalBlue.opacity(0.3))
            .scaleEffect(scale)
            .opacity(opacity)
            .onAppear {
                withAnimation(
                    .easeInOut(duration: 1.5)
                    .repeatForever(autoreverses: true)
                ) {
                    scale = 1.3
                    opacity = 0
                }
            }
    }
}
```

### 6.2 å½•éŸ³æŒ‰é’®åŠ¨ç”»

```swift
// æŒ‰ä¸‹ç¼©æ”¾
.scaleEffect(isPressed ? 1.1 : 1.0)
.animation(.spring(response: 0.3), value: isPressed)

// å½•éŸ³ä¸­æ³¢çº¹
.overlay(
    Circle()
        .stroke(Color.recordingBlue, lineWidth: 3)
        .scaleEffect(isRecording ? 1.5 : 1.0)
        .opacity(isRecording ? 0 : 1)
        .animation(
            .easeOut(duration: 1.0)
            .repeatForever(autoreverses: false),
            value: isRecording
        )
)
```

### 6.3 æ‰“å­—æœºæ•ˆæœ

```swift
// AI æ¶ˆæ¯é€å­—æ˜¾ç¤º
struct TypewriterText: View {
    let fullText: String
    @State private var displayedText = ""
    
    var body: some View {
        Text(displayedText)
            .onAppear {
                for (index, char) in fullText.enumerated() {
                    DispatchQueue.main.asyncAfter(deadline: .now() + 0.05 * Double(index)) {
                        displayedText.append(char)
                    }
                }
            }
    }
}
```

---

## ä¸ƒã€æƒé™ä¸éšç§

### 7.1 æ‰€éœ€æƒé™

| æƒé™ | ç”¨é€” | è¯·æ±‚æ—¶æœº |
|------|------|----------|
| éº¦å…‹é£ | è¯­éŸ³è¾“å…¥ | é¦–æ¬¡ç‚¹å‡»ã€Œå¼€å§‹é€šè¯ã€|
| è¯­éŸ³è¯†åˆ« | è¯­éŸ³è½¬æ–‡å­— | é¦–æ¬¡ç‚¹å‡»ã€Œå¼€å§‹é€šè¯ã€|

### 7.2 Info.plist é…ç½®

```xml
<key>NSMicrophoneUsageDescription</key>
<string>éœ€è¦ä½¿ç”¨éº¦å…‹é£è¿›è¡Œè¯­éŸ³é—®è¯Š</string>

<key>NSSpeechRecognitionUsageDescription</key>
<string>éœ€è¦è¯­éŸ³è¯†åˆ«å°†æ‚¨çš„è¯­éŸ³è½¬æ¢ä¸ºæ–‡å­—</string>
```

### 7.3 éšç§è¯´æ˜

```
1. è¯­éŸ³è¯†åˆ«ä½¿ç”¨ iOS ç³»ç»Ÿ APIï¼Œå¯é€‰æ‹©æœ¬åœ°è¯†åˆ«ï¼ˆiOS 13+ï¼‰
2. å¯¹è¯å†…å®¹é€šè¿‡ HTTPS åŠ å¯†ä¼ è¾“
3. é€šè¯è®°å½•ä¿å­˜åœ¨ç”¨æˆ·è´¦æˆ·ä¸‹ï¼Œç”¨æˆ·å¯åˆ é™¤
4. ä¸ä¼šå°†åŸå§‹éŸ³é¢‘ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆä»…ä¼ æ–‡å­—ï¼‰
```

---

## å…«ã€æµ‹è¯•ç”¨ä¾‹

### 8.1 åŠŸèƒ½æµ‹è¯•

| åœºæ™¯ | é¢„æœŸç»“æœ |
|------|----------|
| é€‰æ‹©çš®è‚¤ç§‘ â†’ å¼€å§‹é€šè¯ | è¿›å…¥å‘¼å«é¡µ â†’ è¿æ¥æˆåŠŸ â†’ è¿›å…¥é€šè¯ |
| æŒ‰ä½è¯´è¯ â†’ è¯´ã€Œæˆ‘æ‰‹è‡‚ç—’ã€â†’ æ¾å¼€ | æ˜¾ç¤ºå®æ—¶å­—å¹• â†’ AI å›å¤ â†’ è¯­éŸ³æ’­æŠ¥ |
| é€šè¯ä¸­æ‹ç…§ | æ‰“å¼€ç›¸æœº â†’ æ‹ç…§ â†’ å›¾ç‰‡å‘é€ç»™ AI |
| æŒ‚æ–­ | æ˜¾ç¤ºé—®è¯Šæ‘˜è¦ â†’ å¯ç”Ÿæˆç—…å† |
| AI è¯´è¯æ—¶æŒ‰ä½è¯´è¯ | ä¸­æ–­ AI æ’­æŠ¥ â†’ å¼€å§‹å½•éŸ³ |

### 8.2 å¼‚å¸¸æµ‹è¯•

| åœºæ™¯ | é¢„æœŸç»“æœ |
|------|----------|
| æ‹’ç»éº¦å…‹é£æƒé™ | å¼¹çª—å¼•å¯¼å¼€å¯æƒé™ |
| ç½‘ç»œæ–­å¼€ | é¡¶éƒ¨çº¢æ¡æç¤º â†’ è‡ªåŠ¨é‡è¿ |
| è¯´è¯å£°éŸ³è¿‡å° | Toastã€Œæ²¡æœ‰æ£€æµ‹åˆ°å£°éŸ³ã€|
| åå°åˆ‡æ¢ | ä¿æŒé€šè¯ â†’ è¿”å›åç»§ç»­ |

### 8.3 æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| è¯­éŸ³è¯†åˆ«å»¶è¿Ÿ | < 500ms |
| AI å“åº”æ—¶é—´ | < 3s (é¦–å­—) |
| å†…å­˜å ç”¨ | < 100MB |
| CPU å ç”¨ | < 30% (å½•éŸ³æ—¶) |

---

## ä¹ã€è¿­ä»£è§„åˆ’

### Phase 1: MVPï¼ˆ1å‘¨ï¼‰
- [x] åŸºç¡€é€šè¯ç•Œé¢
- [x] è¯­éŸ³è¾“å…¥ï¼ˆæŒ‰ä½è¯´è¯ï¼‰
- [x] è¯­éŸ³è¾“å‡ºï¼ˆAI æœ—è¯»ï¼‰
- [x] ç§‘å®¤é€‰æ‹©
- [x] åŸºç¡€é”™è¯¯å¤„ç†

### Phase 2: ä½“éªŒä¼˜åŒ–ï¼ˆ0.5å‘¨ï¼‰
- [ ] è¯­éŸ³æ³¢å½¢åŠ¨ç”»
- [ ] æ‰“å­—æœºæ•ˆæœ
- [ ] å‘¼å«/æŒ‚æ–­åŠ¨ç”»
- [ ] è§¦è§‰åé¦ˆ

### Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆ1å‘¨ï¼‰
- [ ] å…ææ¨¡å¼ï¼ˆVADï¼‰
- [ ] é€šè¯ä¸­æ‹ç…§
- [ ] ä¸­æ–­ AI æ’­æŠ¥
- [ ] é€šè¯å½•éŸ³å›æ”¾

### Phase 4: è´¨é‡å®Œå–„ï¼ˆ0.5å‘¨ï¼‰
- [ ] æ— éšœç¢é€‚é…
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] è¾¹ç•Œç”¨ä¾‹æµ‹è¯•

---

## åã€ç›¸å…³æ–‡æ¡£

- [å¤šæ™ºèƒ½ä½“æ¶æ„è®¾è®¡](./multi-agent-architecture-v2.md)
- [API å¥‘çº¦æ–‡æ¡£](../API_CONTRACT.md)
- [iOS å¼€å‘æŒ‡å—](../IOS_DEVELOPMENT_GUIDE.md)

---

**æ–‡æ¡£ç»´æŠ¤è€…**: é¡¹ç›®å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2026-01-18  
**ä¸‹æ¬¡å®¡æŸ¥**: æ¯ä¸ª Phase å®Œæˆåæ›´æ–°
